<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="å‘ç€è´¢å¯Œä¸è‡ªç”±å‰è¿›å§">
    <meta name="author" content="Keep Team">
    
    <title>
        
            åˆ©ç”¨çˆ¬è™«ç”ŸæˆäºŒæ‰‹æˆ¿çƒ­åŠ›å›¾ |
        
        Keep Theme
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.svg">
    
<link rel="stylesheet" href="/fontawesome/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/css/regular.min.css">

    
<link rel="stylesheet" href="/fontawesome/css/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/css/brands.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.xml"};
    KEEP.theme_config = {"toc":{"enable":false,"number":false,"expand_all":false,"init_open":false},"style":{"primary_color":"#0066cc","logo":"/images/logo.svg","favicon":"/images/logo.svg","avatar":"/images/avatar.svg","font_size":null,"font_family":null,"hover":{"shadow":false,"scale":false},"first_screen":{"enable":false,"header_transparent":false,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving.","font_color":null,"hitokoto":false},"scroll":{"progress_bar":false,"percent":false}},"local_search":{"enable":false,"preload":false},"code_copy":{},"code_block":{"tools":{"enable":false,"style":"default"},"highlight_theme":"default"},"side_tools":{},"pjax":{"enable":false},"lazyload":{"enable":false},"comment":{"enable":false,"use":"valine","valine":{"appid":null,"appkey":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.7"},"waline":{"server_url":null,"reaction":false,"version":2}},"post":{"author_label":{"enable":true,"auto":true,"custom_label_list":["Trainee","Engineer","Architect"]},"word_count":{"enable":false,"wordcount":false,"min2read":false},"img_align":"left","copyright_info":false},"version":"3.5.2"};
    KEEP.language_ago = {"second":"%s ç§’å‰","minute":"%s åˆ†é’Ÿå‰","hour":"%s å°æ—¶å‰","day":"%s å¤©å‰","week":"%s å‘¨å‰","month":"%s ä¸ªæœˆå‰","year":"%s å¹´å‰"};
    KEEP.language_code_block = {"copy":"å¤åˆ¶ä»£ç ","copied":"å·²å¤åˆ¶","fold":"æŠ˜å ä»£ç å—","folded":"å·²æŠ˜å "};
  </script>
<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>


<body>
<div class="progress-bar-container">
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="/images/logo.svg">
                </a>
            
            <a class="logo-title" href="/">
               Keep Theme
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                é¦–é¡µ
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                å½’æ¡£
                            </a>
                        </li>
                    
                    
                </ul>
            </div>
            <div class="mobile">
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">é¦–é¡µ</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">å½’æ¡£</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            <div class="article-title">
                <span class="title-hover-animation">åˆ©ç”¨çˆ¬è™«ç”ŸæˆäºŒæ‰‹æˆ¿çƒ­åŠ›å›¾</span>
            </div>

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="/images/avatar.svg">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">Keep Team</span>
                            
                                <span class="author-label">Lv4</span>
                            
                        </div>
                        <div class="meta-info">
                            
<div class="article-meta-info">
    <span class="article-date article-meta-item">
        
            <i class="fa-regular fa-calendar-plus"></i>&nbsp;
        
        <span class="pc">2021-07-04 23:00:00</span>
        <span class="mobile">2021-07-04 23:00</span>
    </span>
    
        <span class="article-update-date article-meta-item">
        <i class="fas fa-file-pen"></i>&nbsp;
        <span class="pc">2022-10-25 14:08:34</span>
    </span>
    
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/Python/">Python</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/Python/">Python</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Docker/">Docker</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Selenium/">Selenium</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content keep-markdown-body">
                <p>â€ƒâ€ƒæ›¾ç»åœ¨<a class="link" target="_blank" rel="noopener" href="https://www.ray0728.cn/2021/06/20/%E6%90%AD%E5%BB%BA%E5%9C%A8%E7%BA%BFSelenium%E6%89%A7%E8%A1%8C%E7%8E%AF%E5%A2%83/">ã€Šæ­å»ºåœ¨çº¿Seleniumæ‰§è¡Œç¯å¢ƒã€‹<i class="fas fa-external-link-alt"></i></a>ä¸­æ ‘äº†ä¸€ä¸ªFlagã€‚</p>
<blockquote>
<p>å¯ä»¥é€šè¿‡å°†è„šæœ¬ä¸Šä¼ è‡³æœåŠ¡å™¨ä¸Šï¼Œè®©æœåŠ¡å™¨è‡ªåŠ¨æŒ‚æœºæ‰§è¡Œã€‚ä¸€å¤œçˆ¬éæŸä¹ä¹Ÿä¸æ˜¯æ¢¦äº†ï¼ˆè¿˜ä¸ç”¨æ‹…å¿ƒå¦ˆå¦ˆè®©æˆ‘å…³ç”µè„‘äº†ï¼‰</p>
</blockquote>
<p>â€ƒâ€ƒå”‰ï¼ŒFlagç«‹å¾—å€’æ˜¯æŒºè½»æ¾çš„ï¼Œå…ˆçœ‹çœ‹æˆ‘çš„å°äº‘å·²ç»æœ‰äº†é‚£äº›åŠŸèƒ½å§ï¼Œå½“å‰å‰ç«¯å·²èƒ½<a class="link" target="_blank" rel="noopener" href="https://code.ray0728.cn/">åœ¨çº¿ç¼–è¾‘å¹¶è¿è¡ŒPythonè„šæœ¬<i class="fas fa-external-link-alt"></i></a>ï¼Œåç«¯å¯<a class="link" target="_blank" rel="noopener" href="https://www.ray0728.cn/2020/05/21/%E6%90%AD%E5%BB%BASelenium%E6%89%A7%E8%A1%8C%E7%8E%AF%E5%A2%83/">é€šè¿‡Dockeræ‰§è¡ŒSeleniumçˆ¬è™«è„šæœ¬<i class="fas fa-external-link-alt"></i></a>ï¼Œä¼¼ä¹ä¸‡äº‹å…·å¤‡ï¼Œåªæ¬ æ•´åˆäº†ã€‚é‚£ä»Šå¤©å°±æ¥å¡«å‘å§ï¼Œçœ‹çœ‹æ€ä¹ˆè®©æœåŠ¡å™¨ï¼ˆäº‘ï¼‰æŒ‚æœºæ‰§è¡Œçˆ¬è™«å§ã€‚</p>
<span id="more"></span>

<h3 id="å®šç›®æ ‡"><a href="#å®šç›®æ ‡" class="headerlink" title="å®šç›®æ ‡"></a>å®šç›®æ ‡</h3><p>â€ƒâ€ƒä¸‡äº‹å¼€å¤´éƒ½å¾—å®šç›®æ ‡ï¼Œé‚£æˆ‘ä¹Ÿå®šä¸ªå°ç›®æ ‡å§ï¼Œåˆšå¥½æœ€è¿‘é¢†å¯¼æƒ³ä¹°æˆ¿å­ï¼Œä½†æ˜¯å®³æ€•ä»¥åå¢å€¼ç©ºé—´ä¸å¤§ï¼Œæ¯•ç«Ÿç°åœ¨ä¼ªå£å²¸ä¹ŸæŒºå¤šçš„ã€‚é‚£å°±å†™ä¸ªçˆ¬è™«çˆ¬çˆ¬æŸå®¶çš„äºŒæ‰‹æˆ¿æ•°æ®å§ï¼Œç”¨æ•°æ®æ¥çœ‹çœ‹åˆ°åº•é‚£äº›åŒºåŸŸæœ€çº¢ç«ï¼Œé‚£äº›åŒºåŸŸæœ‰ä»·æ— å¸‚ã€‚</p>
<h3 id="å†™è„šæœ¬"><a href="#å†™è„šæœ¬" class="headerlink" title="å†™è„šæœ¬"></a>å†™è„šæœ¬</h3><p>â€ƒâ€ƒçˆ¬è™«è„šæœ¬ç¼–å†™å¾ˆç®€å•ï¼Œè¿™é‡Œå°±ä¸å±•å¼€äº†ï¼Œç®€å•æ¥è¯´å°±æ˜¯æ‰“å¼€ã€æœç´¢ã€è·å–ã€ç‚¹å‡»ã€å†æœç´¢ã€å†è·å–ï¼Œå¹¶é‡å¤ä»¥ä¸Šçš„æ“ä½œï¼Œç›´åˆ°è„šæœ¬çš„å®Œæˆã€‚</p>
<p>â€ƒâ€ƒåœ¨ç¼–å†™è„šæœ¬çš„æ—¶å€™ï¼Œå‘ç°é‡‡é›†ä¸‹æ¥çš„æ•°æ®é‡å¾ˆå¤§ï¼Œè€Œä¸”é¢‘ç¹çˆ¬å–æŸå®¶çš„æ•°æ®ï¼Œæ‹…å¿ƒæˆ‘çš„å°äº‘è¢«å…³è¿›å°é»‘å±‹ ä»¥åå†ä¹Ÿä¸èƒ½å·çˆ¬æŸå®¶çš„æ•°æ®äº†ï¼Œå› æ­¤éœ€è¦å°†æ•°æ®ç¼“å­˜èµ·æ¥ï¼Œå¯ä»¥é€‰æ‹©Redisä¹Ÿå¯ä»¥é€‰æ‹©MySQLï¼Œè€Œæˆ‘é€‰æ‹©äº†MariaDBï¼ˆMySQLçš„åˆ†æ”¯ç‰ˆæœ¬ï¼‰ã€‚è¿™æ ·å®Œæˆçš„è„šæœ¬å¤§æ¦‚å°±åƒä¸‹é¢è¿™æ ·å­ï¼ˆä»…ä¸»å‡½æ•°ä»£ç ï¼‰ï¼š</p>
<pre class="line-numbers language-py" data-language="py"><code class="language-py">driver = initDriver()
helper = SQLHelper()
helper.clearData()
try:
    for page in range(1,101): driver.get("https://{}.lianjia.com/ershoufang/pg{}".format(city, page))
        cards = driver.find_elements_by_xpath('//div[@class="info clear"]')
        for card in cards:
            house = card.find_element_by_xpath('.//div[@class="flood"]/div[@class="positionInfo"]/a[1]').get_attribute('textContent')
            region = card.find_element_by_xpath('.//div[@class="flood"]/div[@class="positionInfo"]/a[2]').get_attribute('textContent')
            info = card.find_element_by_xpath('.//div[@class="address"]/div[@class="houseInfo"]').get_attribute('textContent').split("|")
            price = card.find_element_by_xpath('.//div[@class="priceInfo"]/div[@class="totalPrice"]/span').get_attribute('textContent')
            helper.insertNewHouse(region, house, info[1].strip().rstrip("å¹³ç±³"),info[4].strip(), price)
        helper.autoUpdateHouseInfo()
finally:
    helper.close()
    close(driver)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>â€ƒâ€ƒå¦‚ä»£ç æ‰€è¿°ï¼Œé‡‡é›†åä¼šå°†å…³é”®ä¿¡æ¯ä¿å­˜è¿›æ•°æ®åº“ã€‚è„šæœ¬æœ‰äº†ï¼Œé‚£å°±è¯¥è®©è„šæœ¬èƒ½è‡ªåŠ¨è¿è¡Œèµ·æ¥äº†ã€‚</p>
<h3 id="å®šæ—¶å™¨Cron"><a href="#å®šæ—¶å™¨Cron" class="headerlink" title="å®šæ—¶å™¨Cron"></a>å®šæ—¶å™¨Cron</h3><p>â€ƒâ€ƒè¦è‡ªåŠ¨å”¤èµ·è„šæœ¬ï¼Œå¯ä»¥ç”¨Shellå®šæ—¶è„šæœ¬å¦‚ï¼š</p>
<pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">sleep 3h;python yourscrip.py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>â€ƒâ€ƒåœ¨å…¶åŸºç¡€ä¸ŠåŠ ä¸Š<code>while...do....done</code>å°±å¯ä»¥å®ç°å¾ªç¯å®šæ—¶æ‰§è¡Œäº†ã€‚å¯æ˜¯è¿™ä¸ªæ–¹æ³•æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ç¡çœ çš„æ—¶é—´æ— æ³•å›ºå®šã€‚</p>
<p>â€ƒâ€ƒä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘å¸Œæœ›æ¯1å°æ—¶æ‰§è¡Œä¸€æ¬¡è„šæœ¬ï¼Œæ‰€ä»¥ç”¨äº†sleep 1hï¼Œå¯æ˜¯è„šæœ¬æ‰§è¡Œæ˜¯éœ€è¦æ—¶é—´çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ç¬¬äºŒæ¬¡æ‰§è¡Œçš„æ—¶é—´ç›¸è¾ƒäºç¬¬ä¸€æ¬¡æ‰§è¡Œçš„æ—¶é—´å¹¶ä¸æ˜¯åªè¿‡å»äº†1ä¸ªå°æ—¶ï¼Œè€Œæ˜¯è¿‡å»äº†1å°æ—¶åŠ ä¸Šè„šæœ¬æ‰§è¡Œçš„è€—æ—¶ï¼Œè€Œè¿™ä¸ªæ—¶å·®ä¼šç´¯ç§¯çš„ï¼Œå¾ªç¯æ¬¡æ•°è¶Šå¤šï¼Œåˆ™è¯¯å·®è¶Šå¤§ã€‚</p>
<p>â€ƒâ€ƒå†è€…ï¼Œæˆ‘å®é™…å¸Œæœ›è„šæœ¬èƒ½åœ¨å‡Œæ™¨3ç‚¹æ‰§è¡Œï¼Œè¿™æ ·å¯¹æœåŠ¡å™¨è´Ÿè½½ä¼šè½»ä¸€ç‚¹ã€‚é‚£ä¹ˆåº”è¯¥sleepå¤šå°‘å‘¢ï¼Ÿæ˜¯ä¸æ˜¯ä¸€è„¸æ‡µé€¼ï¼Ÿç»¼åˆä»¥ä¸Šä¸¤ä¸ªåŸå› ï¼Œç”¨sleepå¹¶ä¸é€‚åˆå½“å‰çš„åœºæ™¯ã€‚</p>
<p>â€ƒâ€ƒCronæ˜¯Linuxçš„å®šæ—¶ä»»åŠ¡æ‰§è¡ŒæœåŠ¡ï¼Œå®ƒä¼šæ ¹æ®é…ç½®å®šæ—¶å¯åŠ¨ä»»åŠ¡æ‰§è¡Œï¼Œç±»ä¼¼Windowsçš„å®šæ—¶ä»»åŠ¡ã€‚è¯¦ç»†ä»‹ç»å¯å‚è€ƒ<a class="link" target="_blank" rel="noopener" href="https://www.runoob.com/w3cnote/linux-crontab-tasks.html">èœé¸Ÿæ•™ç¨‹<i class="fas fa-external-link-alt"></i></a>æˆ–è‡ªè¡Œç™¾åº¦ã€‚ä½†æ˜¯cronæœ‰ä¸€ä¸ªå·¨å¤§çš„å‘ï¼Œå·®ä¸å¤šæœ‰ä¸‹å›¾è¿™ä¹ˆå¤§ï¼Œåé¢å†å•ç‹¬å†™ä¸€ä¸ªå…³äºcronå¡«å‘å®å½•å§ğŸ˜‚ã€‚</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://arts.ray0728.cn/images/2021/07/04/1625402697759.jpg" alt="å¤©å‘"></p>
<p>â€ƒâ€ƒé…ç½®å¥½cronï¼Œå®‰ç½®å¥½å‡†å¤‡å¥½çš„è„šæœ¬ï¼Œå°±å¯ä»¥åç­‰å°ç›®æ ‡å®ç°äº†ã€‚ä¸è¿‡ï¼Œå¥½åƒå·®ç‚¹ä»€ä¹ˆã€‚å”‰ï¼Ÿå”‰ï¼Ÿæ˜¯ä¸æ˜¯è¿˜å·®ä¸ªå‰ç«¯æ˜¾ç¤ºå•Šï¼Œä¸ç„¶çˆ¬å®Œçš„æ•°æ®è¿˜æ˜¯æ•°æ®å•Šï¼Œå±…ç„¶å¿˜äº†è¿™ä¸ªè¿™ä¹ˆé‡è¦çš„äº‹æƒ…ã€‚</p>
<h3 id="çƒ­åŠ›å›¾"><a href="#çƒ­åŠ›å›¾" class="headerlink" title="çƒ­åŠ›å›¾"></a>çƒ­åŠ›å›¾</h3><p>â€ƒâ€ƒå‰ç«¯æ€ä¹ˆæ˜¾ç¤ºæ•°æ®å‘¢ï¼ŒæŸ±çŠ¶å›¾ï¼Ÿæ›²çº¿ï¼Ÿè¿˜æ˜¯è¡¨æ ¼ï¼Ÿå“ˆå“ˆå“ˆï¼Œéƒ½ä¸æ˜¯ï¼Œæœ¬äººé€‰æ‹©äº†æœ€ç®€å•çš„çƒ­åŠ›å›¾ã€‚</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://arts.ray0728.cn/images/2021/07/04/b-ssl.duitang.jpg" alt="å‰è…°"></p>
<p>â€ƒâ€ƒçƒ­åŠ›å›¾é€‰æ‹©é«˜å¾·åœ°å›¾æ¥å®ç°çš„ï¼Œå¹¶å¤ç”¨äº†<a class="link" target="_blank" rel="noopener" href="https://www.ray0728.cn/2021/06/24/%E6%90%AD%E5%BB%BA%E5%9C%A8%E7%BA%BFSelenium%E6%89%A7%E8%A1%8C%E7%8E%AF%E5%A2%83%EF%BC%88%E4%BA%8C%EF%BC%89/">ã€Šæ­å»ºåœ¨çº¿Seleniumæ‰§è¡Œç¯å¢ƒã€‹<i class="fas fa-external-link-alt"></i></a>ä¸­å·²å®ç°çš„å‰åç«¯æ•°æ®é€šé“ã€‚åˆ©ç”¨BootStrap4åšäº†ä¸€ä¸ªç®€å•çš„å‰ç«¯ç•Œé¢ï¼Œæœ€ç»ˆå®ç°çš„æ•ˆæœè¿˜ä¸é”™ã€‚</p>
<p><img lazyload="" src="/images/loading.svg" data-src="https://arts.ray0728.cn/images/2021/07/04/Screenshot_20210704_214812.md.jpg" alt="çƒ­åŠ›å›¾"></p>
<p>â€ƒâ€ƒé«˜å¾·çƒ­åŠ›å›¾æœ‰ä¸€ä¸ªå°å‘ï¼Œä»–å®˜ç½‘ä¸Šèƒ½æœåˆ°å¤šä¸ªç‰ˆæœ¬çš„çƒ­åŠ›å›¾æ•°æ®æ–¹å¼ï¼Œä½†å…¶å®åªæœ‰ä¸€ç§èƒ½æˆåŠŸã€‚ä¼ å…¥çš„æ•°æ®ä¸€å®šè¦æ˜¯æ•°ç»„ç»“æ„ï¼Œä¸”æ¯ä¸ªç‚¹éœ€è¦æ˜¯å“ˆå¸Œç»“æ„ï¼Œjså¤§è‡´å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> heatlayer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    heatlayer <span class="token operator">=</span> <span class="token function">initMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">loaddata</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> wss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">'wssåœ°å€'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    wss<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> onCloseWss<span class="token punctuation">)</span><span class="token punctuation">;</span>
    wss<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> onMessageWss<span class="token punctuation">)</span><span class="token punctuation">;</span>
    wss<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        wss<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'å‘èµ·æ•°æ®è¯·æ±‚'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">onCloseWss</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">onMessageWss</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> hdata <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    heatlayer<span class="token punctuation">.</span><span class="token function">setDataSet</span><span class="token punctuation">(</span><span class="token punctuation">{</span>data<span class="token operator">:</span> hdata<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    heatlayer<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">initMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AMap<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token string">'map'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        resizeEnable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        center<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.066593</span><span class="token punctuation">,</span><span class="token number">30.657789</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        zoom<span class="token operator">:</span> <span class="token number">11</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">setMapStyle</span><span class="token punctuation">(</span><span class="token string">'amap://styles/d04f6e9640ff8cc28c800c925a2dd146'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isSupportCanvas</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'The heat map is applicable only to browsers that support canvas. The browser you are using cannot use the heat map function. Please try another browser.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> heatlayer<span class="token punctuation">;</span>
    map<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"AMap.Heatmap"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        heatlayer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AMap<span class="token punctuation">.</span>Heatmap</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            radius<span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
            opacity<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> heatlayer<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">isSupportCanvas</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> elem <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">!</span><span class="token operator">!</span><span class="token punctuation">(</span>elem<span class="token punctuation">.</span>getContext <span class="token operator">&amp;&amp;</span> elem<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>â€ƒâ€ƒå‰ç«¯ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™ï¼Œä¼šè§¦å‘loaddataå‡½æ•°ï¼Œè¿›ä¸€æ­¥é€šè¿‡websocketå»åå°è·å–JSONæ ¼å¼çš„æ•°æ®ï¼Œå¹¶è½¬æ¢ä¸ºæ•°ç»„ä¼ é€’ç»™Mapã€‚</p>
<h3 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h3><p>â€ƒâ€ƒæœ€åä»çƒ­åŠ›å›¾ä¸Šå¤§è‡´çœ‹å‡ºï¼Œæœç„¶å¤©åºœæ–°åŒºåœ¨æˆ‘å¤§æˆéƒ½çƒ­å¾—ä¸æ˜¯ä¸€ç‚¹åŠç‚¹å‘¢ï¼ˆå½“ç„¶æ»‘åŠ¨åœ°é“ï¼Œè¿˜èƒ½å‘ç°å…¶ä»–æ›´æœ‰æ„æ€çš„äº‹å„¿å‘¢ï¼‰ã€‚å¾—èµ¶ç´§å‘é¢†å¯¼æ±‡æŠ¥ä¸‹æˆæœäº†ï¼Œå¸Œæœ›ä»Šå¹´äº‘æœåŠ¡å™¨çš„é’±å¯ä»¥æŠ¥é”€äº†ã€‚</p>

            </div>

            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/Python/">#Python</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="/tags/Docker/">#Docker</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="/tags/Selenium/">#Selenium</a>&nbsp;
                        </li>
                    
                </ul>
            

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                               rel="prev"
                               href="/2021/07/13/210713-cron%E8%B6%9F%E5%9D%91%E4%B9%8B%E6%97%85/"
                            >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                                <span class="title flex-center">
                                <span class="post-nav-title-item">cronè¶Ÿå‘ä¹‹æ—…</span>
                                <span class="post-nav-item">ä¸Šä¸€ç¯‡</span>
                            </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                               rel="next"
                               href="/2021/06/24/210624-%E6%90%AD%E5%BB%BA%E5%9C%A8%E7%BA%BFSelenium%E6%89%A7%E8%A1%8C%E7%8E%AF%E5%A2%83%EF%BC%88%E4%BA%8C%EF%BC%89/"
                            >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">æ­å»ºåœ¨çº¿Seleniumæ‰§è¡Œç¯å¢ƒï¼ˆäºŒï¼‰</span>
                                <span class="post-nav-item">ä¸‹ä¸€ç¯‡</span>
                            </span>
                                <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                            </a>
                        </div>
                    
                </div>
            

            
        </div>

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            
<footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
                <span>2020</span> -
            
            2023
            
                &nbsp;<i class="fas fa-heart icon-animate"></i>
                &nbsp;<a href="/">Keep Team</a>
            
        </div>
        
        <div class="theme-info info-item">
            ç”± <a target="_blank" href="https://hexo.io">Hexo</a> é©±åŠ¨&nbsp;|&nbsp;ä¸»é¢˜&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.5.2</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>










<div class="post-scripts">
    
        
<script src="/js/post-helper.js"></script>

        
        
    
</div>



</body>
</html>
